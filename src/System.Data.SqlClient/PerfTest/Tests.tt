<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ output extension=".cs" #>
<#
    var aliases = new[] { "SqlClientSlim", "SqlClientFull" };
    foreach (var alias in aliases)
    {
        WriteLine("extern alias " + alias + ";");
    }
#>

namespace PerfTest
{
<#
    foreach (var alias in aliases)
    {
        string qualifier = alias + "::System.Data.SqlClient.";
#>

    internal static class <#= alias #>Tests
    {
        private const string SqlAuthConnectionString = "server=localhost;user id=sa;password=452g34f23t4324t2g43t;";

        public static void OpenPooledConnectionTest()
        {
            using (var connection = new <#= qualifier #>SqlConnection(SqlAuthConnectionString))
            {
                connection.OpenAsync().Wait();
            }
        }

        public static void SelectParametersTest()
        {
            using (var connection = new <#= qualifier #>SqlConnection(SqlAuthConnectionString))
            using (var command = new <#= qualifier #>SqlCommand("SELECT @number, @string", connection))
            {
                command.Parameters.Add(new <#= qualifier #>SqlParameter("number", 1));
                command.Parameters.Add(new <#= qualifier #>SqlParameter("string", "Hello, World!"));

                connection.OpenAsync().Wait();
                using (var reader = command.ExecuteReaderAsync().Result)
                {
                    reader.ReadAsync().Wait();

                    reader.GetFieldValue<int>(0);
                    reader.GetFieldValue<string>(1);
                }
            }
        }
    }

<#
    }
#>
}